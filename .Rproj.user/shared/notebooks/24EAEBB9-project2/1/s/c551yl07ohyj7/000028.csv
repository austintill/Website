"0",""
"0","#10-fold CV"
"0","set.seed(1234)"
"0","k=10"
"0",""
"0","data<-Wong[sample(nrow(Wong)),] #randomly order rows"
"0","folds<-cut(seq(1:nrow(Wong)),breaks=k,labels=F) #create folds"
"0",""
"0","diags<-NULL"
"0","for(i in 1:k){"
"0","  ## Create training and test sets"
"0","  train<-data[folds!=i,] "
"0","  test<-data[folds==i,]"
"0","  truth<-test$sex"
"0","  "
"0","  ## Train model on training set"
"0","  fit<-glm(sex~piq+viq+duration,data=train,family=""binomial"")"
"0","  probs<-predict(fit,newdata = test,type=""response"")"
"0","  "
"0","  ## Test model on test set (save all k results)"
"0","  diags<-rbind(diags,class_diag(probs,truth))"
"0","}"
"0",""
"0",""
"0","summarize_all(diags,mean)"
